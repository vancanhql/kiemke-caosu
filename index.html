<!DOCTYPE html>
<html lang="vi">
  <style>
/* ·∫®n to√†n b·ªô header + navbar c·ªßa Blogspot */
#header-wrapper,
#Header1,
.header,
.navbar,
.navbar-wrapper,
#navbar-iframe,
#blog-pager,
.blog-pager {
  display: none !important;
}

/* Xo√° kho·∫£ng tr·ªëng ph√≠a tr√™n */
body {
  padding-top: 0 !important;
  margin-top: 0 !important;
}
</style>

<head>
<meta charset="UTF-8">
<title>Ki·ªÉm k√™ v∆∞·ªùn c√¢y cao su</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- SheetJS -->
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
:root{
  --green-main:#2e7d32;
  --green-light:#e8f5e9;
  --green-btn:#43a047;
  --orange:#fb8c00;
  --yellow:#fdd835;
  --purple:#7e57c2;
  --red:#e53935;
  --gray:#6c757d;
}
/* ===== FORCE DESKTOP VIEW ‚Äì T·∫ÆT MOBILE BLOGGER ===== */
@media only screen and (max-width: 800px) {
  body {
    -webkit-text-size-adjust: 100%;
  }
}

body{
  font-family: "Segoe UI", Arial, sans-serif;
  margin:0;
  background:linear-gradient(#e8f5e9,#ffffff);
}

header{
  background:var(--green-main);
  color:white;
  padding:14px;
  text-align:center;
  font-size:22px;
  font-weight:bold;
}

.container{
  padding:12px;
}

.box{
  background:white;
  border-radius:14px;
  padding:14px;
  margin-bottom:14px;
  box-shadow:0 4px 10px rgba(0,0,0,0.08);
}

h3{
  text-align:center;
  margin-top:0;
  color:var(--green-main);
}

input{
  width:100%;
  font-size:18px;
  padding:10px;
  border-radius:10px;
  border:1px solid #ccc;
  margin-bottom:10px;
}

button{
  border:none;
  border-radius:14px;
  font-size:22px;
  height:70px;
  margin:6px 4px;
  cursor:pointer;
}

.btn-full{
  width:100%;
  background:var(--green-btn);
  color:white;
}

.btn-small{
  width:100%;
  height:56px;
  font-size:18px;
  background:#eeeeee;
}

.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
}

.btn-G{background:#66bb6a;color:white;}
.btn-O{background:var(--orange);color:white;}
.btn-K1{background:var(--yellow);}
.btn-K2{background:var(--purple);color:white;}
.btn-D{grid-column:1/3;background:var(--red);color:white;}

#tree{
  text-align:center;
  font-size:28px;
  margin:8px 0;
}

#info{
  text-align:center;
  font-size:16px;
  color:#555;
}

#lastType{
  text-align:center;
  font-weight:bold;
  font-size:20px;
  margin-bottom:6px;
}

footer{
  text-align:center;
  font-size:13px;
  color:#555;
  padding:10px 0 14px;
}
</style>
  <link rel="manifest" href="data:application/json,{
  &quot;name&quot;: &quot;Kiem ke vuon cay cao su&quot;,
  &quot;short_name&quot;: &quot;Kiem ke cao su&quot;,
  &quot;start_url&quot;: &quot;.&quot;,
  &quot;display&quot;: &quot;standalone&quot;,
  &quot;background_color&quot;: &quot;#e8f5e9&quot;,
  &quot;theme_color&quot;: &quot;#2e7d32&quot;,
  &quot;orientation&quot;: &quot;portrait&quot;,
  &quot;icons&quot;: [
    {
      &quot;src&quot;: &quot;https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhFTF4CDBtNjSWq4dG0yJkRa28qsXKRcUsITz_6P1vRgDOKf9YSTI5fQt4yjKD61GSSVV_JFO1rBPHFvHPatxfr8cq4jjsXJ4ms_1JFHsl7fj1YdRztvPhKvxosqBRfOqtePFxX1Ud8yC-JcDbwNxjQIW2E5amKk_0l1nvaMZ-B4TnfLrK4HlqeyjKihJ1h/s320/icon-192.png&quot;,
      &quot;sizes&quot;: &quot;192x192&quot;,
      &quot;type&quot;: &quot;image/png&quot;
    },
    {
      &quot;src&quot;: &quot;https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiJnGe8Vo9atS1cTfHQVdzxdYn7BEUEpl63y-aHzmLVQNL2bGp6OZVZLhwx1NcBWRMeQE0sRyIVKrj0taY9wsPA3AYDX5cqweaze_ksTmWKW9AAWTk8k6b5N1o0ZQ-aT_M3kmP-SbChANsG0AlUuam35PLVd_e8qCwCv8Mi-NgPDDKyE4psmSEYHXvB4pPC/s320/icon-512.png&quot;,
      &quot;sizes&quot;: &quot;512x512&quot;,
      &quot;type&quot;: &quot;image/png&quot;
    }
  ]
}">
<meta name="theme-color" content="#2e7d32">

</head>

<body>

<header>
  üå± KI·ªÇM K√ä V∆Ø·ªúN C√ÇY CAO SU
</header>

<div class="container">

<!-- ===== KH·ªûI T·∫†O L√î ===== -->
<div id="setup" class="box">
  <h3>Kh·ªüi t·∫°o l√¥</h3>
  T√™n l√¥ <input id="lo">
  NƒÉm tr·ªìng <input id="namTrong" type="number">
  Di·ªán t√≠ch (ha) <input id="dienTich" type="number" step="0.01">
  S·ªë h√†ng <input id="soHang" type="number">
  <button class="btn-full" onclick="startLo()">B·∫ÆT ƒê·∫¶U KI·ªÇM K√ä</button>
</div>

<!-- ===== KI·ªÇM K√ä ===== -->
<div id="counter" class="box" style="display:none;">
  <div id="info"></div>
  <div id="tree">C√¢y s·ªë: 1</div>
  <div id="lastType">V·ª´a nh·∫≠p: -</div>

  <div class="grid">
    <button class="btn-G" onclick="count('G')">G</button>
    <button class="btn-O" onclick="count('O')">O</button>
    <button class="btn-K1" onclick="count('K1')">K1</button>
    <button class="btn-K2" onclick="count('K2')">K2</button>
    <button class="btn-D" onclick="count('D')">D</button>
  </div>

  <button class="btn-small" onclick="undoLast()">‚Ü© S·ª¨A C√ÇY V·ª™A NH·∫¨P</button>
  <button class="btn-full" onclick="finishRow()">HO√ÄN T·∫§T H√ÄNG</button>
</div>

<!-- ===== CU·ªêI NG√ÄY ===== -->
<div class="box">
  <button class="btn-full" onclick="exportAll()">XU·∫§T EXCEL CU·ªêI NG√ÄY</button>
  <button class="btn-small" onclick="clearData()">XO√Å TO√ÄN B·ªò D·ªÆ LI·ªÜU</button>
</div>

</div>

<footer>
  ¬© Copyright by <b>vancanhql@gmail.com</b>
</footer>

<script>
/* ===== M√ÄU LO·∫†I C√ÇY ===== */
const typeColors={
  "G":"#66bb6a",
  "O":"#fb8c00",
  "K1":"#fdd835",
  "K2":"#7e57c2",
  "D":"#e53935"
};

let dsLo=JSON.parse(localStorage.getItem("dsLo")||"[]");
let loHT=null,hang=1,cay=1;

function startLo(){
  loHT={lo:lo.value,namTrong:namTrong.value,dienTich:dienTich.value,soHang:+soHang.value,data:[]};
  hang=1;cay=1;
  setup.style.display="none";
  counter.style.display="block";
  resetLastType();
  updateInfo();
}

function updateInfo(){
  info.innerText=`L√¥: ${loHT.lo} | NƒÉm tr·ªìng: ${loHT.namTrong} | DT: ${loHT.dienTich} ha | H√†ng: ${hang}/${loHT.soHang}`;
  tree.innerText=`C√¢y s·ªë: ${cay}`;
}

function resetLastType(){
  lastType.innerText="V·ª´a nh·∫≠p: -";
  lastType.style.color="#000";
}

function count(type){
  loHT.data.push({hang,cay,type});
  lastType.innerText="V·ª´a nh·∫≠p: "+type;
  lastType.style.color=typeColors[type];
  cay++;
  updateInfo();
}

function undoLast(){
  if(loHT.data.length==0) return alert("Ch∆∞a c√≥ c√¢y ƒë·ªÉ s·ª≠a");
  let last=loHT.data.at(-1);
  if(last.hang!==hang) return alert("Kh√¥ng th·ªÉ s·ª≠a c√¢y h√†ng tr∆∞·ªõc");
  loHT.data.pop(); cay=Math.max(1,cay-1);
  lastType.innerText="V·ª´a nh·∫≠p: (ƒë√£ xo√°)";
  lastType.style.color="#6c757d";
  updateInfo();
}

function finishRow(){
  alert(`Xong h√†ng ${hang}`);
  hang++; cay=1;
  if(hang>loHT.soHang) finishLo();
  else{ resetLastType(); updateInfo(); }
}

function finishLo(){
  dsLo.push(loHT);
  localStorage.setItem("dsLo",JSON.stringify(dsLo));
  alert(`ƒê√£ l∆∞u xong ${loHT.lo}`);
  counter.style.display="none";
  setup.style.display="block";
}

function exportAll(){
  let ds=JSON.parse(localStorage.getItem("dsLo")||"[]");
  if(ds.length==0) return alert("Ch∆∞a c√≥ l√¥ n√†o");
  let wb=XLSX.utils.book_new();

  ds.forEach((lo,i)=>{
    let s1=[["STT","L√¥","NƒÉm tr·ªìng","Di·ªán t√≠ch","H√†ng","C√¢y","Lo·∫°i"]];
    lo.data.forEach((d,j)=>s1.push([j+1,lo.lo,lo.namTrong,lo.dienTich,d.hang,d.cay,d.type]));
    XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet(s1),`LO${i+1}_CT`);
  });

  XLSX.writeFile(wb,"KiemKe_CuoiNgay.xlsx");
}

function clearData(){
  if(confirm("Xo√° to√†n b·ªô d·ªØ li·ªáu?")){
    localStorage.removeItem("dsLo");
    dsLo=[];
    alert("ƒê√£ xo√° xong");
  }
}
</script>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js')
    .then(function () {
      console.log('PWA ready');
    })
    .catch(function (err) {
      console.error(err);
    });
}
</script>


</body>
</html>

